(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7bcf4b94"],{"09f4":function(e,t,i){"use strict";i.d(t,"a",function(){return o}),Math.easeInOutQuad=function(e,t,i,a){return e/=a/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function s(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(e,t,i){var o=l(),n=e-o,r=20,u=0;t="undefined"===typeof t?500:t;var c=function e(){u+=r;var l=Math.easeInOutQuad(u,o,n,t);s(l),u<t?a(e):i&&"function"===typeof i&&i()};c()}},"6b70":function(e,t,i){},deb3:function(e,t,i){"use strict";var a=i("6b70"),s=i.n(a);s.a},f31f:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("el-button",{staticClass:"btnPosition",attrs:{type:"primary"},on:{click:e.addTest}},[e._v("创建题库类型")]),e._v(" "),i("el-scrollbar",[i("el-tree",{ref:"tree",attrs:{data:e.treeData,props:e.defaultProps,"default-expand-all":"","node-key":"id"},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node,s=t.data;return i("span",{staticClass:"custom-tree-node",on:{mouseenter:function(t){return e.mouseenter(s)},mouseleave:function(t){return e.mouseleave(s)}}},[i("span",[e._v(e._s(a.label))]),e._v(" "),a.isLeaf?i("span",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:s.show,expression:"data.show"}],attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(t){return t.stopPropagation(),function(){return e.remove(a,s)}()}}})],1):e._e(),e._v(" "),a.isLeaf||a.parent.parent?e._e():i("span",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:s.show,expression:"data.show"}],attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(t){return t.stopPropagation(),function(){return e.add(a,s)}()}}})],1)])}}])})],1)],1),e._v(" "),i("el-col",{attrs:{span:18}},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.listQuery,size:"medium"}},[i("el-form-item",[i("el-input",{staticClass:"inputSize",attrs:{placeholder:"请输入查询内容"},model:{value:e.listQuery.topicColumn,callback:function(t){e.$set(e.listQuery,"topicColumn",t)},expression:"listQuery.topicColumn"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.onSubmit}},[e._v("搜索")])],1),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.openFileDialog}},[e._v("题目导入")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{"default-expand-all":!0,data:e.list,border:"",fit:!0,stripe:!0,"highlight-current-row":""}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-row",{attrs:{title:t.row.topicOption}},e._l(t.row.optionArr,function(t,a){return i("span",{key:a,staticClass:"spanSty"},[e._v(e._s(t))])}),0)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"题目","min-width":"300",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{attrs:{title:t.row.topicColumn}},[e._v(e._s(t.row.topicColumn))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"答案",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.topicResult))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleModifyStatus(a,"edit")}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleModifyStatus(a,"delete")}}},[e._v("删除")])]}}])})],1),e._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getTestList}})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},["create"===e.dialogStatus||"create1"===e.dialogStatus?i("el-form",{staticClass:"demo-form-inline questionForm",attrs:{inline:!0,rules:e.rules,model:e.temp,size:"medium"}},[i("el-form-item",{attrs:{label:"创建科目：",prop:"subjectName"}},["create"===e.dialogStatus?i("el-input",{attrs:{placeholder:"请输入科目名称"},model:{value:e.temp.subjectName,callback:function(t){e.$set(e.temp,"subjectName",t)},expression:"temp.subjectName"}}):e._e(),e._v(" "),"create1"===e.dialogStatus?i("el-input",{attrs:{placeholder:"请输入科目名称",readonly:""},model:{value:e.temp.subjectName,callback:function(t){e.$set(e.temp,"subjectName",t)},expression:"temp.subjectName"}}):e._e()],1),e._v(" "),i("el-form-item",{attrs:{label:"科目题型：",prop:"subjectType"}},[i("el-select",{staticClass:"filter-item",attrs:{filterable:"",placeholder:"请选择科目题型"},model:{value:e.temp.subjectType,callback:function(t){e.$set(e.temp,"subjectType",t)},expression:"temp.subjectType"}},e._l(e.typeList,function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)],1)],1):e._e(),e._v(" "),"update"===e.dialogStatus?i("el-form",{staticClass:"demo-form-inline questionForm",attrs:{inline:!0,rules:e.rules,model:e.updateTemp,size:"medium"}},[i("el-form-item",{attrs:{label:"题目：",prop:"topicColumn"}},[i("el-input",{attrs:{placeholder:"请输入试题题目"},model:{value:e.updateTemp.topicColumn,callback:function(t){e.$set(e.updateTemp,"topicColumn",t)},expression:"updateTemp.topicColumn"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"选项：",prop:"topicOption"}},[i("el-input",{attrs:{placeholder:"请输入试题选项"},model:{value:e.updateTemp.topicOption,callback:function(t){e.$set(e.updateTemp,"topicOption",t)},expression:"updateTemp.topicOption"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"答案：",prop:"topicResult"}},[i("el-input",{attrs:{placeholder:"请输入正确答案"},model:{value:e.updateTemp.topicResult,callback:function(t){e.$set(e.updateTemp,"topicResult",t)},expression:"updateTemp.topicResult"}})],1)],1):e._e(),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.saveDialog}},[e._v("确 定")]),e._v(" "),i("el-button",{on:{click:e.handleClose}},[e._v("取 消")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"题目导入",visible:e.importFileDialog,width:"40%",accept:".xls,.xlsx","before-close":e.closeFileDialog},on:{"update:visible":function(t){e.importFileDialog=t}}},[i("div",{staticClass:"downDiv"},[i("h3",[e._v("上传模板")]),e._v(" "),i("div",{staticStyle:{"text-align":"center"}},[i("el-radio-group",{model:{value:e.radiofileType,callback:function(t){e.radiofileType=t},expression:"radiofileType"}},e._l(e.typeList,function(t){return i("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.name))])}),1)],1)]),e._v(" "),e.moBanList.length>0?i("div",{staticClass:"downDiv"},[i("h3",[e._v("下载模板")]),e._v(" "),i("div",{staticStyle:{"text-align":"center"}},e._l(e.moBanList,function(t){return i("el-row",{key:t.fileId,staticStyle:{height:"30px","line-height":"30px"},attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("span",[e._v(e._s(e._f("fileType")(t.fileType))+"：")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"left"},attrs:{span:18}},[i("a",{staticStyle:{"text-decoration":"underline",color:"#3377FF"},attrs:{href:"#"},on:{click:function(i){return e.downMOBan(t.fileId)}}},[e._v(e._s(t.fileName))])])],1)}),1)]):e._e(),e._v(" "),i("div",{staticClass:"centerPosition"},[i("div",{staticClass:"downDiv"},[i("h3",{staticStyle:{"text-align":"left"}},[e._v("上传附件")])]),e._v(" "),e.radiofileType?i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",multiple:!1,limit:1,"auto-upload":!1,"with-credentials":!0,action:e.fileUploadUrl,data:e.fileData,"on-success":e.successFile,"on-error":e.errorFile}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击上传")])]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持上传excel等格式")])]):i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",multiple:!1,limit:1,"auto-upload":!1,"with-credentials":!0,action:e.saveFileModel,data:e.fileMobanData,"on-success":e.successFile,"on-error":e.errorFile}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击上传")])]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持上传excel等格式")])])],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitFile}},[e._v("确 定")]),e._v(" "),i("el-button",{on:{click:e.closeFileDialog}},[e._v("取 消")])],1)])],1)},s=[],l=(i("28a5"),i("b775"));function o(e){return Object(l["a"])({url:"/app/xlgl/xlglexamsubject/save",method:"post",data:e})}function n(){return Object(l["a"])({url:"/app/xlgl/xlglexamsubject/subject",method:"get"})}function r(e){return Object(l["a"])({url:"/app/xlgl/xlglexamtopic/list",method:"get",params:e})}function u(e){return Object(l["a"])({url:"/app/xlgl/xlglexamsubject/update",method:"post",data:e})}function c(e){return Object(l["a"])({url:"/app/xlgl/xlglexamtopic/delete",method:"post",data:e})}function p(e){return Object(l["a"])({url:"/app/xlgl/xlglexamtopic/update",method:"post",data:e})}function d(e){return Object(l["a"])({url:"/app/xlgl/xlglexamtopic/info",method:"post",data:e})}function m(e){return Object(l["a"])({url:"/app/xlgl/xlglexamfile/list",method:"post",data:e})}var f=i("333d"),g={name:"ComplexTable",components:{Pagination:f["a"]},filters:{fileType:function(e){var t="";switch(e){case"1":t="单选";break;case"2":t="单选";break;case"3":t="单选";break;case"4":t="单选";break}return t}},data:function(){return{treeData:[],defaultProps:{children:"children",label:"label"},tableKey:0,list:null,total:0,listLoading:!1,listQuery:{topicType:"",subjectId:"",topicColumn:"",page:1,limit:20},typeList:[{name:"单选",value:"1"},{name:"多选",value:"2"},{name:"判断",value:"3"},{name:"填空",value:"4"},{name:"简答",value:"5"}],temp:{subjectName:"",subjectType:""},updateTemp:{topicColumn:"",topicOption:"",topicResult:""},dialogVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"新增题库类型",create1:"新增题库类型"},rules:{subjectName:[{required:!0,message:"请输入科目名称",trigger:"blur"}],subjectType:[{required:!0,message:"请选择科目题型",trigger:"change"}],topicColumn:[{required:!0,message:"请输入试题题目",trigger:"blur"}],topicOption:[{required:!0,message:"请输入试题选项",trigger:"blur"}],topicResult:[{required:!0,message:"请输入正确答案",trigger:"blur"}]},radiofileType:"",importFileDialog:!1,moBanList:[],fileData:{access_token:this.$store.state.user.token,subjectId:""},fileMobanData:{fileType:this.radiofileType},fileUploadUrl:"/app/xlgl/xlglexamtopic/readExcelSave",saveFileModel:"/app/xlgl/xlglexamtopic/upLoadFile"}},watch:{listQuery:{handler:function(e){},deep:!0}},created:function(){this.getTreeList()},methods:{addTest:function(){this.dialogStatus="create",this.dialogVisible=!0},saveDialog:function(){var e=this;"update"===this.dialogStatus?(this.updateTemp.topicColumn||this.$message({type:"info",message:"请输入试题题目"}),this.updateTemp.topicOption||this.$message({type:"info",message:"请输入试题选项"}),this.updateTemp.topicResult||this.$message({type:"info",message:"请输入正确答案"}),this.updateTemp.topicColumn&&this.updateTemp.topicOption&&this.updateTemp.topicResult&&p(this.updateTemp).then(function(t){0===t.data.code?e.$message({type:"success",message:"修改成功!",onClose:function(){e.handleClose(),e.getTestList()}}):e.$message({type:"info",message:t.data.msg})})):(this.temp.subjectName||this.$message({type:"info",message:"请输入科目名称"}),this.temp.subjectType||this.$message({type:"info",message:"请选择科目题型"}),this.temp.subjectName&&this.temp.subjectType&&o({subjectName:this.temp.subjectName,subjectType:this.temp.subjectType}).then(function(t){0===t.data.code?e.$message({type:"success",message:"题库类型添加成功!",onClose:function(){e.handleClose(),e.getTreeList()}}):e.$message({type:"info",message:t.data.msg})}))},handleClose:function(){"update"===this.dialogStatus?this.updateTemp={topicColumn:"",topicOption:"",topicResult:""}:this.temp={subjectName:"",subjectType:""},this.dialogVisible=!1},getTreeList:function(){var e=this;n().then(function(t){e.treeData=t.data,e.$nextTick(function(){this.treeData.length>1&&(this.$refs.tree.setCurrentKey(this.treeData[0].children[0].id),this.listQuery.subjectId=this.treeData[0].id,this.listQuery.topicType=this.treeData[0].children[0].type,this.getTestList())})})},remove:function(e,t){var i=this,a=e.parent,s=a.data.children||a.data,l=[];s.length>1&&s.map(function(e){e.type!=t.type&&l.push(e.type)}),u({id:a.data.id,delType:t.type,subjectType:l.join(",")}).then(function(e){0===e.data.code?i.$message({type:"success",message:"删除成功!",onClose:function(){i.getTreeList()}}):i.$message({type:"info",message:e.data.msg})})},add:function(e,t){this.dialogStatus="create1",this.temp.subjectName=t.label,this.dialogVisible=!0},mouseenter:function(e){this.$set(e,"show",!0)},mouseleave:function(e){this.$set(e,"show",!1)},handleNodeClick:function(e,t){e.type&&(this.listQuery={subjectId:t.parent.data.id,topicType:e.type,page:this.listQuery.page,limit:this.listQuery.limit},this.fileData.subjectId=t.parent.data.id,this.getTestList())},openFileDialog:function(){this.getMobanList(),this.importFileDialog=!0},closeFileDialog:function(){this.$refs.upload.clearFiles(),this.radiofileType="",this.importFileDialog=!1},submitFile:function(){this.$refs.upload.submit()},successFile:function(){var e=this;this.$message({type:"success",message:"上传成功!",onClose:function(){e.closeFileDialog()}})},errorFile:function(){this.$message({type:"info",message:"上传失败！"})},onSubmit:function(){this.getTestList()},getTestList:function(){var e=this;this.listLoading=!0,r(this.listQuery).then(function(t){t.data.page.list.map(function(e){e.optionArr=e.topicOption.split(",")}),e.list=t.data.page.list,e.total=t.data.page.totalCount,setTimeout(function(){e.listLoading=!1},1500)})},handleModifyStatus:function(e,t){var i=this;"edit"===t?(this.dialogStatus="update",this.dialogVisible=!0,d({id:e.id}).then(function(e){i.updateTemp=e.data.xlglExamTopic})):"delete"===t&&c({ids:e.id}).then(function(e){0===e.data.code?i.$message({type:"success",message:"删除成功!",onClose:function(){i.getTestList()}}):i.$message({type:"info",message:e.data.msg})})},getMobanList:function(){var e=this;m().then(function(t){e.moBanList=t.data.list})},downMOBan:function(e){window.location.href="/app/xlgl/xlglexamtopic/downloadFile?topicType="+this.listQuery.topicType+"&fileId="+e+"&access_token="+this.$store.state.user.token}}},h=g,v=(i("deb3"),i("2877")),b=Object(v["a"])(h,a,s,!1,null,"bd2fcda6",null);t["default"]=b.exports}}]);