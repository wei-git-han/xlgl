(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2cb1547f","chunk-6d496a02"],{"14b9":function(e,t,s){var a=s("5ca1");a(a.P,"String",{repeat:s("9744")})},"2f21":function(e,t,s){"use strict";var a=s("79e5");e.exports=function(e,t){return!!e&&a(function(){t?e.call(null,function(){},1):e.call(null)})}},"386b":function(e,t,s){var a=s("5ca1"),n=s("79e5"),i=s("be13"),r=/"/g,l=function(e,t,s,a){var n=String(i(e)),l="<"+t;return""!==s&&(l+=" "+s+'="'+String(a).replace(r,"&quot;")+'"'),l+">"+n+"</"+t+">"};e.exports=function(e,t){var s={};s[e]=t(l),a(a.P+a.F*n(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",s)}},"55dd":function(e,t,s){"use strict";var a=s("5ca1"),n=s("d8e8"),i=s("4bf8"),r=s("79e5"),l=[].sort,o=[1,2,3];a(a.P+a.F*(r(function(){o.sort(void 0)})||!r(function(){o.sort(null)})||!s("2f21")(l)),"Array",{sort:function(e){return void 0===e?l.call(i(this)):l.call(i(this),n(e))}})},"7db8":function(e,t,s){"use strict";var a=s("c068"),n=s.n(a);n.a},9744:function(e,t,s){"use strict";var a=s("4588"),n=s("be13");e.exports=function(e){var t=String(n(this)),s="",i=a(e);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(s+=t);return s}},"9ec8":function(e,t,s){"use strict";s("386b")("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},af91:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"addPage"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticStyle:{"padding-bottom":"100px",position:"relative"}},[s("title-card",{attrs:{"title-text":"训管动态新增"}}),e._v(" "),s("svg-icon",{staticClass:"icon",staticStyle:{cursor:"pointer",position:"absolute",right:"20px",top:"15px"},attrs:{"icon-class":"goback"},on:{click:e.backFn}}),e._v(" "),s("div",{staticStyle:{padding:"20px 0"}},[s("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"150px"}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"动态类型",prop:"newsType"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.newsType,callback:function(t){e.$set(e.form,"newsType",t)},expression:"form.newsType"}},[s("el-option",{attrs:{label:"上级工作动态",value:"上级工作动态"}}),e._v(" "),s("el-option",{attrs:{label:"机关部队训练风采",value:"机关部队训练风采"}}),e._v(" "),s("el-option",{attrs:{label:"安全管理",value:"安全管理"}})],1)],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"发布单位",required:""}},[s("el-input",{attrs:{disabled:""},model:{value:e.deptName,callback:function(t){e.deptName=t},expression:"deptName"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"动态标题",prop:"title"}},[s("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:20}},[s("el-form-item",{attrs:{label:"编辑内容"}},[s("ueditor",{ref:"content",model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"上传封面"}},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{accept:".png,.jpeg",drag:"",action:e.fileUrl,data:e.access_token,name:"pdf","file-list":e.imgList,"list-type":"picture","on-success":e.uploadImg,"on-error":e.errorFile,"on-remove":e.removeImg,"on-change":e.handleChangeFile,multiple:""}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("\n                  将文件拖到此处，或"),s("em",[e._v("点击上传")]),e._v(" "),s("div",{staticStyle:{color:"#BBBBBB","font-size":"12px"}},[e._v("注：只能上传.mp4/.png/.jpeg等文件格式")])])])],1)],1)],1)],1),e._v(" "),s("el-col",{staticStyle:{"text-align":"center","margin-top":"30px"},attrs:{span:24}},[s("el-button",{attrs:{type:"success"},on:{click:e.saveFn}},[e._v("发布")]),e._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:"0"!=e.flag,expression:"flag!='0'"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.saveDraft}},[e._v("存草稿")])],1)],1)],1)],1)},n=[],i=(s("28a5"),s("aa2a")),r=s("35b7"),l=s("63f4"),o={components:{Ueditor:l["a"],TitleCard:r["a"]},props:{id:{type:String,default:""},flag:{type:String,default:""}},data:function(){return{form:{title:"",newsType:"",content:"",pIds:"",picutureName:""},rules:{newsType:[{required:!0,message:"请选择动态类型",trigger:"change"}],title:[{required:!0,message:"请填写动态标题",trigger:"blur"}]},deptName:"",isRelease:"",imgList:[],fileUrl:"/app/xlgl/news/upLoadFile",access_token:this.$store.state.user.token}},created:function(){this.getDeptName(),this.id&&this.eidtOrUpdate()},methods:{getDeptName:function(){var e=this;Object(i["d"])().then(function(t){e.deptName=t.data.deptName})},eidtOrUpdate:function(){var e=this;Object(i["f"])({id:this.id}).then(function(t){var s=t.data.xlglNews,a=s.title,n=s.newsType,i=s.content;Object.assign(e.form,{title:a,newsType:n,content:i}),e.isRelease=t.data.xlglNews.isRelease,t.data.xlglNews.picturePath&&e.imgList.push({name:t.data.xlglNews.pictureName,url:"/app/xlgl/xlgldocumentfile/downLoad?fileId=".concat(t.data.xlglNews.picturePath)}),e.$refs.content.setContent(e.form.content)})},backFn:function(){this.$emit("back",0)},uploadImg:function(e){e.fileId&&e.fileId.length>0?(this.form.pIds=e.fileId,this.form.picutureName=e.picutureName):this.errorFile()},errorFile:function(){this.$message({type:"info",message:"上传失败!"})},removeImg:function(e){var t=this;Object(i["c"])({infoId:this.id,pictureId:e.url.split("=")[1]}).then(function(e){"success"===e.data.result?(t.$message({message:"图片删除成功",type:"success"}),t.form.picutureName="",t.form.pIds=""):t.$message({type:"info",message:"图片删除失败!"})})},handleChangeFile:function(e,t){t.length>1&&t.splice(0,1)},saveData:function(e,t){var s=this;this.$refs[t].validate(function(t){if(!t)return!1;s.form.isRelease=e,s.form.content=s.$refs.content.getContent(),s.id&&(s.form.id=s.id),Object(i["i"])(s.form).then(function(t){"success"===t.data.result?s.id?("1"===e&&"1"===s.isRelease&&s.$message({type:"success",message:"修改成功"}),"0"===e&&s.$message({type:"success",message:"存入草稿箱成功"}),"1"===e&&"0"===s.isRelease&&s.$message({type:"success",message:"发布成功"})):("1"===e&&s.$message({type:"success",message:"发布成功"}),"0"===e&&s.$message({type:"success",message:"存入草稿箱成功"})):s.id?("1"===e&&"1"===s.isRelease&&s.$message({type:"success",message:"修改失败"}),"0"===e&&s.$message({type:"success",message:"存入草稿箱失败"}),"1"===e&&"0"===s.isRelease&&s.$message({type:"success",message:"发布失败"})):("1"===e&&s.$message({type:"success",message:"发布失败"}),"0"===e&&s.$message({type:"success",message:"存入草稿箱失败"})),s.form="",s.$emit("back",0)})})},saveFn:function(){this.saveData("1","form")},saveDraft:function(){this.saveData("0","form")}}},c=o,u=(s("7db8"),s("2877")),p=Object(u["a"])(c,a,n,!1,null,"531f8777",null);t["default"]=p.exports},c068:function(e,t,s){}}]);