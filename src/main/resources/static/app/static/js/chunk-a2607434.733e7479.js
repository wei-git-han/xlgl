(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a2607434"],{"1a38":function(e,t,s){},"8b36":function(e,t,s){"use strict";var i=s("1a38"),a=s.n(i);a.a},aa6a:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"app-content"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticClass:"borderSty",staticStyle:{"padding-bottom":"100px"}},[s("div",{staticClass:"addTitle"},[s("span",[e._v("通知公告新增")]),e._v(" "),s("svg-icon",{staticClass:"icon",staticStyle:{cursor:"pointer","margin-top":"10px"},attrs:{"icon-class":"goback"},on:{click:e.backFn}})],1),e._v(" "),s("div",{staticStyle:{padding:"20px 0"}},[s("el-form",{ref:"form",attrs:{"label-width":"150px"},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"信息类型",required:""}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.infoType,function(t){return s("el-option",{key:t.value,attrs:{label:t.name,value:t.name}},[e._v(e._s(t.name))])}),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"发布单位",required:""}},[s("el-input",{attrs:{disabled:""},model:{value:e.form.releaseOrgan,callback:function(t){e.$set(e.form,"releaseOrgan",t)},expression:"form.releaseOrgan"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"信息标题",required:""}},[s("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"发布时间",required:""}},[s("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择发布时间"},model:{value:e.form.releaseTimeStr,callback:function(t){e.$set(e.form,"releaseTimeStr",t)},expression:"form.releaseTimeStr"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:20}},[s("el-form-item",{attrs:{label:"编辑内容"}},[s("ueditor",{ref:"content",model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:20}},[s("el-form-item",{attrs:{label:"上传附件"}},[s("div",{staticStyle:{border:"1px solid #ccc",padding:"20px","border-radius":"4px"}},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:e.fileUrl,data:e.form,"on-success":e.successFile,"on-error":e.errorFile,"on-remove":e.removeFile,multiple:""}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),s("em",[e._v("点击上传")])]),e._v(" "),s("div",{staticClass:"el-upload__tip",staticStyle:{color:"#BBBBBB"},attrs:{slot:"tip"},slot:"tip"},[e._v("上传word、excel、ofd等文件格式")])]),e._v(" "),s("div",{staticClass:"fileList"},[s("ul",e._l(e.fileLists,function(t){return s("li",{key:t.fileId},[e._v("\n                        "+e._s(t.pictureName)+"\n                        "),s("span",{staticClass:"colorSty1 gapSty",on:{click:function(s){return s.stopPropagation(),e.deleteFileById(t.pictureId)}}},[e._v("删除")]),e._v(" "),s("span",{staticClass:"colorSty1 gapSty",on:{click:function(s){return s.stopPropagation(),e.download(t.pictureId)}}},[e._v("下载")])])}),0)])],1)])],1)],1)],1),e._v(" "),s("el-col",{staticStyle:{"text-align":"center","margin-top":"30px"},attrs:{span:24}},[s("el-button",{attrs:{type:"success"},on:{click:e.saveOrUpdateNotice}},[e._v("发布")]),e._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.backFn}},[e._v("取消")])],1)],1)],1)],1)])},a=[],o=s("aa2a"),l=s("13c4"),n=s("63f4"),r={name:"CreateNotice",components:{Ueditor:n["a"]},props:{noticeId:{type:String,default:""}},data:function(){return{infoType:[{name:"通知",value:"1"},{name:"公告",value:"0"}],fileUrl:"/app/xlgl/xlglnotice/uploadPicture",fileList:[],form:{type:"",title:"",content:"",releaseTimeStr:"",releaseOrgan:"",access_token:this.$store.state.user.token},fileLists:[]}},created:function(){this.noticeId?this.getNoticeInfo():this.getDeptName()},methods:{getDeptName:function(){var e=this;Object(o["d"])().then(function(t){e.form.releaseOrgan=t.data.deptName})},backFn:function(){this.$emit("back","1")},successFile:function(e){e.fileid&&e.fileid.length>0?this.fileList.push(e.fileid):this.$message({type:"info",message:"上传失败!"})},errorFile:function(){this.$message({type:"info",message:"上传失败!"})},removeFile:function(e){var t=this.fileList.indexOf(e.response.fileid);-1!==t&&this.fileList.splice(t,1)},saveOrUpdateNotice:function(){var e=this;this.form.type||this.$message({type:"warning",message:"请选择信息类型!"}),this.form.title||this.$message({type:"warning",message:"请输入信息标题!"}),this.form.releaseTimeStr||this.$message({type:"warning",message:"请选择发布时间!"}),this.form.content=this.$refs.content.getContent(),this.form.type&&this.form.title&&this.form.releaseTimeStr&&(this.form.pIds=this.fileList.join(","),Object(l["i"])(this.form).then(function(t){e.$message({type:"success",message:"发布成功!",onClose:function(){e.$parent.showPage="1"}})}))},getNoticeInfo:function(){var e=this,t={id:this.noticeId};Object(l["f"])(t).then(function(t){e.form.id=t.data.xlglNotice.id,e.form.type=t.data.xlglNotice.type,e.form.releaseOrgan=t.data.xlglNotice.releaseOrgan,e.form.title=t.data.xlglNotice.title,e.form.content=t.data.xlglNotice.content,e.form.releaseTimeStr=t.data.xlglNotice.releaseTime,e.$refs.content.setContent(e.form.content),e.$nextTick(function(){this.getFileList()})})},getFileList:function(){var e=this;Object(l["d"])({id:this.noticeId}).then(function(t){e.fileLists=t.data.list})},deleteFileById:function(e){var t=this,s={picId:e};Object(l["b"])(s).then(function(e){0===e.data.code?t.$message({type:"success",message:"删除成功!",onClose:function(){t.getFileList()}}):t.$message({type:"indo",message:"删除失败!"})})},download:function(e){window.location.href="xlgl/xlglnotice/downloadPicture?fileId="+e+"&access_token="+this.$store.state.user.token}}},c=r,f=(s("8b36"),s("2877")),m=Object(f["a"])(c,i,a,!1,null,"79c1fd84",null);t["default"]=m.exports}}]);