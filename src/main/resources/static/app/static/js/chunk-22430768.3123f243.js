(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22430768","chunk-6d496a02"],{"14b9":function(t,e,a){var n=a("5ca1");n(n.P,"String",{repeat:a("9744")})},"2f21":function(t,e,a){"use strict";var n=a("79e5");t.exports=function(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})}},"386b":function(t,e,a){var n=a("5ca1"),i=a("79e5"),s=a("be13"),r=/"/g,o=function(t,e,a,n){var i=String(s(t)),o="<"+e;return""!==a&&(o+=" "+a+'="'+String(n).replace(r,"&quot;")+'"'),o+">"+i+"</"+e+">"};t.exports=function(t,e){var a={};a[t]=e(o),n(n.P+n.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",a)}},"55dd":function(t,e,a){"use strict";var n=a("5ca1"),i=a("d8e8"),s=a("4bf8"),r=a("79e5"),o=[].sort,l=[1,2,3];n(n.P+n.F*(r(function(){l.sort(void 0)})||!r(function(){l.sort(null)})||!a("2f21")(o)),"Array",{sort:function(t){return void 0===t?o.call(s(this)):o.call(s(this),i(t))}})},9744:function(t,e,a){"use strict";var n=a("4588"),i=a("be13");t.exports=function(t){var e=String(i(this)),a="",s=n(t);if(s<0||s==1/0)throw RangeError("Count can't be negative");for(;s>0;(s>>>=1)&&(e+=e))1&s&&(a+=e);return a}},"9ec8":function(t,e,a){"use strict";a("386b")("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},ada2:function(t,e,a){"use strict";var n=a("c033"),i=a.n(n);i.a},af91:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addPage app-content"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{staticStyle:{"padding-bottom":"100px",position:"relative"}},[a("title-card",{attrs:{"title-text":"训管动态新增"}}),t._v(" "),a("svg-icon",{staticClass:"icon",staticStyle:{cursor:"pointer",position:"absolute",right:"20px",top:"15px"},attrs:{"icon-class":"goback"},on:{click:t.backFn}}),t._v(" "),a("div",{staticStyle:{padding:"20px 0"}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"150px"}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"动态类型",prop:"newsType"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.newsType,callback:function(e){t.$set(t.form,"newsType",e)},expression:"form.newsType"}},[a("el-option",{attrs:{label:"上级工作动态",value:"上级工作动态"}}),t._v(" "),a("el-option",{attrs:{label:"机关部队训练风采",value:"机关部队训练风采"}}),t._v(" "),a("el-option",{attrs:{label:"安全管理",value:"安全管理"}})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"发布单位",required:""}},[a("el-input",{attrs:{disabled:""},model:{value:t.deptName,callback:function(e){t.deptName=e},expression:"deptName"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"动态标题",prop:"title"}},[a("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"编辑内容"}},[a("ueditor",{ref:"content",model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"上传封面"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{accept:".png,.jpeg",drag:"",action:t.fileUrl,data:t.access_token,name:"pdf","file-list":t.imgList,"list-type":"picture","on-success":t.uploadImg,"on-error":t.errorFile,"on-remove":t.removeImg,"on-change":t.handleChangeFile,multiple:""}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("\n                  将文件拖到此处，或"),a("em",[t._v("点击上传")]),t._v(" "),a("div",{staticStyle:{color:"#BBBBBB","font-size":"12px"}},[t._v("注：只能上传.mp4/.png/.jpeg等文件格式")])])])],1)],1)],1)],1),t._v(" "),a("el-col",{staticStyle:{"text-align":"center","margin-top":"30px"},attrs:{span:24}},[a("el-button",{attrs:{type:"success"},on:{click:t.saveFn}},[t._v("发布")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"0"!=t.flag,expression:"flag!='0'"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.saveDraft}},[t._v("存草稿")])],1)],1)],1)],1)},i=[],s=(a("28a5"),a("aa2a")),r=a("35b7"),o=a("63f4"),l={components:{Ueditor:o["a"],TitleCard:r["a"]},props:{id:{type:String,default:""},flag:{type:String,default:""}},data:function(){return{form:{title:"",newsType:"",content:"",pIds:"",picutureName:""},rules:{newsType:[{required:!0,message:"请选择动态类型",trigger:"change"}],title:[{required:!0,message:"请填写动态标题",trigger:"blur"}]},deptName:"",isRelease:"",imgList:[],fileUrl:"/app/xlgl/news/upLoadFile",access_token:this.$store.state.user.token}},created:function(){this.getDeptName(),this.id&&this.eidtOrUpdate()},methods:{getDeptName:function(){var t=this;Object(s["d"])().then(function(e){t.deptName=e.data.deptName})},eidtOrUpdate:function(){var t=this;Object(s["f"])({id:this.id}).then(function(e){var a=e.data.xlglNews,n=a.title,i=a.newsType,s=a.content;Object.assign(t.form,{title:n,newsType:i,content:s}),t.isRelease=e.data.xlglNews.isRelease,e.data.xlglNews.picturePath&&t.imgList.push({name:e.data.xlglNews.pictureName,url:"/app/xlgl/xlgldocumentfile/downLoad?fileId=".concat(e.data.xlglNews.picturePath)}),t.$refs.content.setContent(t.form.content)})},backFn:function(){this.$emit("back",0)},uploadImg:function(t){t.fileId&&t.fileId.length>0?(this.form.pIds=t.fileId,this.form.picutureName=t.picutureName):this.errorFile()},errorFile:function(){this.$notify({title:"提示",message:"上传失败!",duration:1500,type:"warning"})},removeImg:function(t){var e=this;Object(s["c"])({infoId:this.id,pictureId:t.url.split("=")[1]}).then(function(t){"success"===t.data.result?(e.$notify({title:"提示",message:"图片删除成功",duration:1500,type:"success"}),e.form.picutureName="",e.form.pIds=""):e.$notify({title:"提示",message:"图片删除失败!",duration:1500,type:"warning"})})},handleChangeFile:function(t,e){e.length>1&&e.splice(0,1)},saveData:function(t,e){var a=this;this.$refs[e].validate(function(e){if(!e)return!1;a.form.isRelease=t,a.form.content=a.$refs.content.getContent(),a.id&&(a.form.id=a.id),Object(s["i"])(a.form).then(function(e){"success"===e.data.result?a.id?("1"===t&&"1"===a.isRelease&&a.$notify({title:"提示",message:"修改成功!",duration:1500,type:"success"}),"0"===t&&a.$notify({title:"提示",message:"存入草稿箱成功!",duration:1500,type:"success"}),"1"===t&&"0"===a.isRelease&&a.$notify({title:"提示",message:"发布成功!",duration:1500,type:"success"})):("1"===t&&a.$notify({title:"提示",message:"发布成功!",duration:1500,type:"success"}),"0"===t&&a.$notify({title:"提示",message:"存入草稿箱成功!",duration:1500,type:"success"})):a.id?("1"===t&&"1"===a.isRelease&&a.$notify({title:"提示",message:"修改失败!",duration:1500,type:"warning"}),"0"===t&&a.$notify({title:"提示",message:"存入草稿箱失败!",duration:1500,type:"warning"}),"1"===t&&"0"===a.isRelease&&a.$notify({title:"提示",message:"发布失败!",duration:1500,type:"warning"})):("1"===t&&a.$notify({title:"提示",message:"发布失败!",duration:1500,type:"warning"}),"0"===t&&a.$notify({title:"提示",message:"存入草稿箱失败!",duration:1500,type:"warning"})),a.form="",a.$emit("back",0)})})},saveFn:function(){this.saveData("1","form")},saveDraft:function(){this.saveData("0","form")}}},c=l,u=(a("ada2"),a("2877")),f=Object(u["a"])(c,n,i,!1,null,"4e6fe905",null);e["default"]=f.exports},c033:function(t,e,a){}}]);