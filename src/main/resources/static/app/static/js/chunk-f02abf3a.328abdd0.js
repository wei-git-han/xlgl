(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f02abf3a","chunk-2d21a630"],{"4e91":function(e,t,i){},"944c":function(e,t,i){"use strict";var s=i("4e91"),a=i.n(s);a.a},bafa:function(e,t,i){"use strict";i.d(t,"h",function(){return a}),i.d(t,"f",function(){return n}),i.d(t,"c",function(){return r}),i.d(t,"e",function(){return l}),i.d(t,"b",function(){return o}),i.d(t,"d",function(){return u}),i.d(t,"g",function(){return m}),i.d(t,"a",function(){return d});var s=i("b775");function a(e){return Object(s["a"])({url:"/app/xlgl/xlglexamexamine/saveOrUpdate",method:"post",data:e})}function n(){return Object(s["a"])({url:"/app/xlgl/xlglexamsubject/subjectListAll",method:"get"})}function r(e){return Object(s["a"])({url:"/app/xlgl/xlglexamsubject/findTopicBySubId",method:"post",data:e})}function l(e){return Object(s["a"])({url:"/app/xlgl/xlglexamexamine/issueStatusList",method:"post",data:e})}function o(e){return Object(s["a"])({url:"/app/xlgl/xlglexamexamine/delete",method:"post",data:e})}function u(e){return Object(s["a"])({url:"/app/xlgl/xlglexamexamine/info",method:"post",data:e})}function m(e){return Object(s["a"])({url:"/app/xlgl/xlglexamsubject/getTopicNumber",method:"post",data:e})}function d(e){return Object(s["a"])({url:"/app/xlgl/xlglexamexamine/verify",method:"post",data:e})}},fa8e:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"createTest"},[i("title-card",{attrs:{"title-text":e.cardTitle}}),e._v(" "),e.testId?e._e():i("el-button",{staticClass:"noPublish",attrs:{size:"mini",type:"primary"},on:{click:e.showNoPublish}},[e._v("查看未发布考核")]),e._v(" "),i("div",{staticClass:"pageContent"},[i("el-form",{ref:"form",staticClass:"oraganForm",attrs:{model:e.listQuery,rules:e.rules,"label-width":"150px",inline:!0}},[i("el-col",{attrs:{xl:12,md:12}},[i("el-form-item",{attrs:{label:"考试名称：",prop:"examineName"}},[i("el-input",{attrs:{maxlength:"50"},model:{value:e.listQuery.examineName,callback:function(t){e.$set(e.listQuery,"examineName",t)},expression:"listQuery.examineName"}})],1)],1),e._v(" "),i("el-col",{attrs:{xl:12,md:12}},[i("el-form-item",{attrs:{label:"考试时长：",prop:"examineDate"}},[i("el-input",{attrs:{placeholder:"请输入考试时长"},model:{value:e.listQuery.examineDate,callback:function(t){e.$set(e.listQuery,"examineDate",t)},expression:"listQuery.examineDate"}},[i("template",{slot:"append"},[e._v("分")])],2)],1)],1),e._v(" "),i("el-col",{attrs:{xl:12,md:12}},[i("el-form-item",{attrs:{label:"考试时间：",required:""}},[i("el-col",{attrs:{xl:11,md:11}},[i("el-form-item",{attrs:{prop:"examineStartDateStr"}},[i("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime","picker-options":e.pickOptionStart,placeholder:"选择开始时间"},on:{change:e.getsTime1},model:{value:e.listQuery.examineStartDateStr,callback:function(t){e.$set(e.listQuery,"examineStartDateStr",t)},expression:"listQuery.examineStartDateStr"}})],1)],1),e._v(" "),i("el-col",{staticClass:"line",staticStyle:{"text-align":"center"},attrs:{xl:2,md:2}},[e._v("至")]),e._v(" "),i("el-col",{attrs:{xl:11,md:11}},[i("el-form-item",{attrs:{prop:"examineEndDateStr"}},[i("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime","picker-options":e.pickOptionEnd,placeholder:"选择结束时间"},on:{change:e.getsTime2},model:{value:e.listQuery.examineEndDateStr,callback:function(t){e.$set(e.listQuery,"examineEndDateStr",t)},expression:"listQuery.examineEndDateStr"}})],1)],1)],1)],1),e._v(" "),i("el-col",{attrs:{xl:12,md:12}},[i("el-form-item",{attrs:{label:"考试科目选择：",prop:"examineSubjectId"}},[i("el-select",{attrs:{placeholder:"请选择"},on:{change:e.repeatRender},model:{value:e.listQuery.examineSubjectId,callback:function(t){e.$set(e.listQuery,"examineSubjectId",t)},expression:"listQuery.examineSubjectId"}},e._l(e.subjectListAll,function(e){return i("el-option",{key:e.id,attrs:{label:e.subjectName,value:e.id}})}),1)],1)],1)],1),e._v(" "),i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[i("span",{staticStyle:{float:"left"}},[e._v("题型设置")]),e._v(" "),i("span",[e._v("合计：")]),e._v(" "),i("span",[e._v(e._s(e.totalGrade)+"分")]),e._v(" "),i("span",[e._v(e._s(e.totalNum)+"题")])]),e._v(" "),e.setTypes.length<1?i("div",[e._v("\n        该科目无题型\n      ")]):e._e(),e._v(" "),e.showtestSet?e._e():i("el-form",{staticClass:"oraganForm",attrs:{"label-width":"",inline:!0}},e._l(e.setTypes,function(t,s){return i("el-row",{key:s,attrs:{type:"flex",justify:"center"}},[i("el-col",{attrs:{xl:6,md:6}},[i("el-form-item",{attrs:{label:"题型：",prop:"type"}},[i("el-select",{directives:[{name:"required",rawName:"v-required"}],attrs:{placeholder:"请选择",clearable:""},on:{change:e.selectType,clear:function(t){return e.cancelSelect(s)}},model:{value:e.selectedList["type"+s].type1,callback:function(t){e.$set(e.selectedList["type"+s],"type1",t)},expression:"selectedList[`type${index}`].type1"}},e._l(e.typeList,function(t,s){return i("el-option",{key:s,attrs:{label:t.name,disabled:e.getSelectDisabled(t.type),value:t.type}})}),1)],1)],1),e._v(" "),i("el-col",{attrs:{xl:6,md:6}},[i("el-form-item",{attrs:{label:" "}},[i("el-input",{directives:[{name:"limit-num",rawName:"v-limit-num"}],attrs:{placeholder:"请输入多少道题"},model:{value:e.selectedList["type"+s].testNum,callback:function(t){e.$set(e.selectedList["type"+s],"testNum",t)},expression:"selectedList[`type${index}`].testNum"}},[i("template",{slot:"append"},[e._v("题")])],2)],1)],1),e._v(" "),i("el-col",{attrs:{xl:6,md:6}},[i("el-form-item",{attrs:{label:" "}},[i("el-col",{attrs:{xl:24,md:24}},[i("el-input",{directives:[{name:"limit-num",rawName:"v-limit-num"}],attrs:{placeholder:"请输入多少分"},model:{value:e.selectedList["type"+s].testPrice,callback:function(t){e.$set(e.selectedList["type"+s],"testPrice",t)},expression:"selectedList[`type${index}`].testPrice"}},[i("template",{slot:"append"},[e._v("分")])],2)],1)],1)],1)],1)}),1),e._v(" "),e.showtestSet?i("el-form",{staticClass:"oraganForm",attrs:{"label-width":"",inline:!0}},e._l(e.updateInfo,function(t,s){return i("el-row",{key:s,attrs:{type:"flex",justify:"center"}},[i("el-col",{attrs:{xl:6,md:6}},[i("el-form-item",{attrs:{label:"题型：",prop:"type"}},[i("el-select",{directives:[{name:"required",rawName:"v-required"}],attrs:{placeholder:"请选择",clearable:""},on:{change:e.selectType,clear:function(t){return e.cancelSelect(s)}},model:{value:e.selectedList["type"+s].type1,callback:function(t){e.$set(e.selectedList["type"+s],"type1",t)},expression:"selectedList[`type${index}`].type1"}},e._l(e.typeList,function(t,s){return i("el-option",{key:s,attrs:{label:t.name,disabled:e.getSelectDisabled(t.type),value:t.type}})}),1)],1)],1),e._v(" "),i("el-col",{attrs:{xl:6,md:6}},[i("el-form-item",{attrs:{label:" "}},[i("el-input",{directives:[{name:"limit-num",rawName:"v-limit-num"}],attrs:{placeholder:"请输入多少道题"},model:{value:e.selectedList["type"+s].testNum,callback:function(t){e.$set(e.selectedList["type"+s],"testNum",t)},expression:"selectedList[`type${index}`].testNum"}},[i("template",{slot:"append"},[e._v("题")])],2)],1)],1),e._v(" "),i("el-col",{attrs:{xl:6,md:6}},[i("el-form-item",{attrs:{label:" "}},[i("el-col",{attrs:{xl:24,md:24}},[i("el-input",{directives:[{name:"limit-num",rawName:"v-limit-num"}],attrs:{placeholder:"请输入多少分"},model:{value:e.selectedList["type"+s].testPrice,callback:function(t){e.$set(e.selectedList["type"+s],"testPrice",t)},expression:"selectedList[`type${index}`].testPrice"}},[i("template",{slot:"append"},[e._v("分")])],2)],1)],1)],1)],1)}),1):e._e()],1),e._v(" "),i("el-row",{staticStyle:{"text-align":"center",margin:"40px 0px 20px"}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.publicTest("1")}}},[e._v("发起考试")]),e._v(" "),i("el-button",{on:{click:function(t){return e.publicTest("0")}}},[e._v("保存")])],1)],1)],1)},a=[],n=(i("3b2b"),i("a481"),i("ac6a"),i("7f7f"),i("35b7")),r=i("bafa"),l={name:"NoPublish",components:{TitleCard:n["a"]},directives:{required:{inserted:function(e){e.firstElementChild.firstElementChild.addEventListener("blur",function(){var t=e.firstElementChild.firstElementChild.value,i="blobk",s="",a="red";e.nextSibling&&"div"===e.nextSibling.parentNode.lastChild.localName&&e.nextSibling.parentNode.removeChild(e.nextSibling.parentNode.lastChild);var n=document.createElement("div");t.length<1?s="非空":(i="none",a="#dcdfe6"),e.firstElementChild.style.borderColor=a,n.innerText=s,n.style.display=i,n.style.color="red",e.nextSibling&&e.nextSibling.parentNode.appendChild(n)})}},limitNum:{inserted:function(e){e.firstElementChild.addEventListener("blur",function(){var t=e.firstElementChild.value,i="blobk",s="",a="red";e.nextSibling&&"div"===e.nextSibling.parentNode.lastChild.localName&&e.nextSibling.parentNode.removeChild(e.nextSibling.parentNode.lastChild);var n=document.createElement("div");t.length<1?s="非空":/^[1-9]\d*$/.test(t)?(i="none",a="#dcdfe6"):s="只能输入0以外的正整数",e.firstElementChild.style.borderColor=a,n.innerText=s,n.style.display=i,n.style.color="red",e.nextSibling?e.nextSibling.parentNode.appendChild(n):e.parentNode.appendChild(n)})}}},props:{testId:{type:String,default:""}},data:function(){var e=this;return{cardTitle:"创建考核",tableKey:0,list:null,total:0,listLoading:!0,listQuery:{examineName:"",examineDate:"",examineStartDateStr:"",examineEndDateStr:"",examineAllNumber:0,examineSubjectId:"",examineSubjectName:"测试科目",IssueStatus:"0",typeAndNum:"",status:0},typesList:[{type:"1",name:"单选题"},{type:"2",name:"多选题"},{type:"3",name:"判断题"},{type:"4",name:"填空题"}],pickOptionStart:{disabledDate:function(t){var i=e.listQuery.examineEndDateStr;return i?t.getTime()>new Date(i).getTime():t.getTime()<Date.now()-864e5}},pickOptionEnd:{disabledDate:function(t){var i=e.listQuery.examineStartDateStr;return i?t.getTime()<new Date(i).getTime()-864e5:t.getTime()<Date.now()-864e5}},subjectListAll:[],typeList:[],rules:{examineName:[{required:!0,message:"请输入考试名称,长度最多为50个字",trigger:"blur"},{validator:this.checkExamineName,trigger:"blur"}],examineDate:[{required:!0,message:"请输入考试时长",trigger:"blur"},{validator:this.isNum,trigger:"blur"}],examineStartDateStr:[{required:!0,message:"请输入开始时间",trigger:"blur"}],examineEndDateStr:[{required:!0,message:"请输入结束时间",trigger:"blur"}],examineSubjectId:[{required:!0,message:"请选择考试科目",trigger:"change"}]},updateInfo:[],totalGrade:0,totalNum:0,showtestSet:!1,first:!1,updateId:"",testTypeList:[],errorList:[],isLoading:!1,errorOptionList:[],emptyList:[],selectedList:{type0:{type1:null,testNum:null,testPrice:null},type1:{type1:null,testNum:null,testPrice:null},type2:{type1:null,testNum:null,testPrice:null},type3:{type1:null,testNum:null,testPrice:null}}}},computed:{setTypes:function(){return this.typeList}},watch:{"listQuery.examineSubjectId":{handler:function(e,t){var i=this;this.subjectListAll.map(function(e){e.id===i.listQuery.examineSubjectId&&(i.listQuery.examineSubjectName=e.subjectName,i.first||(i.updateInfo=[],i.showtestSet=!1,i.findTopicBySubId(),i.getTopicNumber()))})},deep:!0},selectedList:{handler:function(e,t){var i=0,s=0;for(var a in this.selectedList){var n=this.selectedList[a];i+=this.StringToNumber(n.testNum)*this.StringToNumber(n.testPrice),s+=this.StringToNumber(n.testNum)}this.totalGrade=i,this.totalNum=s},deep:!0}},created:function(){this.getSubjectListAll(),this.testId&&this.getInfoById()},methods:{getsTime1:function(){this.dateToLong(this.listQuery.examineStartDateStr)+6e4<(new Date).getTime()?(this.$notify({title:"提示",message:"开始时间大于当前系统时间,请重新选择开始时间！",duration:1500,type:"warning"}),this.listQuery.examineStartDateStr=""):this.dateToLong(this.listQuery.examineStartDateStr)>this.dateToLong(this.listQuery.examineEndDateStr)&&(this.$notify({title:"提示",message:"开始时间必须小于结束时间,请重新选择开始时间！",duration:1500,type:"warning"}),this.listQuery.examineStartDateStr="")},getSelectDisabled:function(e){var t=!1;for(var i in this.selectedList)this.selectedList[i].type1===e&&(t=!0);return t},getsTime2:function(e){this.listQuery.examineEndDateStr?this.dateToLong(this.listQuery.examineStartDateStr)>this.dateToLong(this.listQuery.examineEndDateStr)&&(this.$notify({title:"提示",message:"结束时间必须大于开始时间,请重新选择结束时间！",duration:1500,type:"warning"}),this.listQuery.examineEndDateStr=""):this.dateToLong(this.listQuery.examineEndDateStr)<Date.now()&&(this.$notify({title:"提示",message:"结束时间必须大于当前系统,请重新选择结束时间！",duration:1500,type:"warning"}),this.listQuery.examineEndDateStr="")},publicTest:function(e){var t=this;this.listQuery.IssueStatus=e;var i=[],s=0,a=!1,n="";if(this.typeList.length<1)this.$notify({title:"提示",message:"该类型的科目没有题型，请先去题库维护中创建题型，导入考试数据！",duration:5500,type:"warning"});else{for(var r in this.emptyList=[],this.selectedList){var l=this.selectedList[r];l.type1&&l.testNum&&l.testPrice?(this.errorNum(l.type1,parseInt(l.testNum)),s+=parseInt(l.testNum)*parseInt(l.testPrice),i.push(l.type1+"-"+l.testNum+"-"+l.testPrice)):!l.type1||l.testNum&&l.testPrice?l.type1||this.emptyList.push(r):this.errorOptionList.push("题型、题量以及每道题的分值都需要输入！ ")}if(this.emptyList.length===this.typeList.length)this.$notify({title:"提示",message:"您还未进行试题的组合设置！",duration:5500,type:"warning"});else if(this.errorOptionList.length>0)this.$notify({title:"提示",message:this.errorOptionList[0],duration:5500,type:"warning",onClose:function(){t.errorList=[],t.errorOptionList=[],t.emptyList=[]}});else{if(this.errorList.length>0){for(var o="",u=0;u<this.errorList.length;u++)o+="<p>"+this.errorList[u].name+"，当前数量是"+this.errorList[u].inputnum+"，题库数量为"+this.errorList[u].originNum+"，组题量不能大于题库数量</p>";n=o,a=!0}this.listQuery.examineEndDateStr||(n="请输入考试结束时间",a=!0),this.listQuery.examineStartDateStr||(n="请输入考试开始时间",a=!0),this.listQuery.examineSubjectId||(n="请选择考试科目",a=!0),this.listQuery.examineDate||(n="请输入考试时长",a=!0),this.listQuery.examineName||(n="请输入考试名称",a=!0),this.listQuery.typeAndNum=i.join(","),this.listQuery.status=0,this.listQuery.examineAllNumber=s,a?this.$notify({title:"提示",dangerouslyUseHTMLString:!0,message:n,duration:1500,type:"warning",onClose:function(){t.errorList=[],t.errorOptionList=[],t.emptyList=[]}}):this.saveTestPaper(e)}}},errorNum:function(e,t){"1"===e&&this.testTypeList[0]<t&&this.errorList.push({type:e,name:"单选题",inputnum:t,originNum:this.testTypeList[0]}),"2"===e&&this.testTypeList[1]<t&&this.errorList.push({type:e,name:"多选题",inputnum:t,originNum:this.testTypeList[1]}),"3"===e&&this.testTypeList[2]<t&&this.errorList.push({type:e,name:"判断题",inputnum:t,originNum:this.testTypeList[2]}),"4"===e&&this.testTypeList[3]<t&&this.errorList.push({type:e,name:"填空题",inputnum:t,originNum:this.testTypeList[3]})},saveTestPaper:function(e){var t=this;this.isLoading=!0;var i="发起考试成功！";"0"===e&&(i="保存成功！");var s=this.listQuery;this.updateId&&(s.id=this.updateId),Object(r["h"])(s).then(function(s){"0"===s.data.code?t.$notify({title:"提示",message:i,duration:1500,type:"success",onClose:function(){if(t.listQuery={},"1"===e?t.$router.push({path:"/trainingAssessment/examinationList"}):t.$emit("showPage","2"),t.updateInfo.length>0){for(var i in t.updateInfo)"totalGradeNum"===i&&"totalTestNum"===i||(t.$set(t.updateInfo[i],"type1",""),t.$set(t.updateInfo[i],"testNum",""),t.$set(t.updateInfo[i],"testPrice",""),t.$set(t.updateInfo[i],"disabled",!1));t.totalGradeNum=0,t.totalTestNum=0}else{for(var s in t.setTypes)"totalGradeNum"===s&&"totalTestNum"===s||(t.$set(t.setTypes[s],"type1",""),t.$set(t.setTypes[s],"testNum",""),t.$set(t.setTypes[s],"testPrice",""),t.$set(t.setTypes[s],"disabled",!1));t.$set(t.setTypes,"totalGradeNum",0),t.$set(t.setTypes,"totalTestNum",0)}}}):t.$notify({title:"提示",message:s.data.msg,duration:1500,type:"warning"}),setTimeout(function(){t.isLoading=!1},500)})},getSubjectListAll:function(){var e=this;Object(r["f"])().then(function(t){e.subjectListAll=t.data.findList,e.subjectListAll.length>1&&(e.listQuery.examineSubjectId=e.subjectListAll[0].id)})},findTopicBySubId:function(){var e=this;Object(r["c"])({subjectId:this.listQuery.examineSubjectId}).then(function(t){e.typeList=[];var i=t.data.findList.type;i.map(function(t){e.typesList.map(function(i){t===i.type&&e.typeList.push(i)})})})},isNum:function(e,t,i){var s=/^[1-9]\d*$/;s.test(t)?i():i(new Error("只能输入除0以外的的正整数"))},selectType:function(e){for(var t=0;t<this.typeList.length;t++)this.typeList[t].type===e&&this.$set(this.typeList[t],"disabled",!0)},cancelSelect:function(e){for(var t=0;t<this.typeList.length;t++)this.typeList[t].type===this.typeList[e].type&&this.$set(this.typeList[e],"disabled",!1)},StringToNumber:function(e){return e?parseInt(e):0},showNoPublish:function(){this.$emit("showPage","2")},getInfoById:function(){var e=this;Object(r["d"])({id:this.testId}).then(function(t){e.first=!0,e.updateId=t.data.xlglExamExamine.id,e.listQuery.examineName=t.data.xlglExamExamine.examineName,e.listQuery.examineDate=t.data.xlglExamExamine.examineDate,e.listQuery.examineStartDateStr=t.data.xlglExamExamine.examineStartDate,e.listQuery.examineEndDateStr=t.data.xlglExamExamine.examineEndDate,e.listQuery.examineSubjectId=t.data.xlglExamExamine.examineSubjectId;var i=t.data.listCount;i.forEach(function(t,s){e.selectedList["type".concat(s)].type1=i[s].topicType,e.selectedList["type".concat(s)].testNum=i[s].typeCount,e.selectedList["type".concat(s)].testPrice=i[s].fractionalNumber,t.type1=i[s].topicType,t.testNum=i[s].typeCount,t.testPrice=i[s].fractionalNumber,e.updateInfo.push(t)}),e.$nextTick(function(){e.showtestSet=!0,e.findTopicBySubId(),e.getTopicNumber(),e.first=!1})})},getTopicNumber:function(){var e=this,t={id:this.listQuery.examineSubjectId};Object(r["g"])(t).then(function(t){var i=t.data;for(var s in e.testTypeList=[],e.errorList=[],i)e.testTypeList.push(i[s])})},checkExamineName:function(e,t,i){var s={examineName:t};Object(r["a"])(s).then(function(e){e.data.status||i(new Error("考试名称重复，请重新输入"))})},dateToLong:function(e){return new Date(e.replace(new RegExp("-","gm"),"/")).getTime()},repeatRender:function(){for(var e in this.selectedList){var t=this.selectedList[e];t.type1=null,t.testNum=null,t.testPrice=null,this.selectedList[e]=t}this.totalGrade=0,this.totalNum=0}}},o=l,u=(i("944c"),i("2877")),m=Object(u["a"])(o,s,a,!1,null,"1e99b2b8",null);t["default"]=m.exports}}]);