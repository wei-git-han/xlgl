(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53407af4"],{"29af":function(e,t,i){},"7a03":function(e,t,i){"use strict";i.d(t,"d",function(){return a}),i.d(t,"a",function(){return l}),i.d(t,"g",function(){return n}),i.d(t,"b",function(){return o}),i.d(t,"f",function(){return r}),i.d(t,"c",function(){return c}),i.d(t,"h",function(){return u}),i.d(t,"e",function(){return f});var s=i("b775");function a(e){return Object(s["a"])({url:"/app/xlgl/xlglsafetyanalyse/list",method:"post",data:e})}function l(e){return Object(s["a"])({url:"/app/xlgl/xlglsafetyanalyse/deletePicture",method:"post",data:e})}function n(e){return Object(s["a"])({url:"/app/xlgl/xlglsafetyanalyse/save",method:"post",data:e})}function o(e){return Object(s["a"])({url:"/app/xlgl/xlglsafetyanalyse/tree",method:"post",data:e})}function r(e){return Object(s["a"])({url:"/app/xlgl/xlglsafetyanalyse/infoList",method:"post",data:e})}function c(e){return Object(s["a"])({url:"/app/xlgl/xlglsafetycheckup/infoByOrganIdOne",method:"post",data:e})}function u(e){return Object(s["a"])({url:"/app/xlgl/xlglsafetyanalyse/update",method:"post",data:e})}function f(e){return Object(s["a"])({url:"/app/xlgl/xlglsafetyanalyse/getUserOrganByRoot",method:"post",data:e})}},cb2c:function(e,t,i){"use strict";var s=i("29af"),a=i.n(s);a.a},ed02:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticStyle:{height:"30px"}},[i("svg-icon",{staticClass:"icon",staticStyle:{float:"right",cursor:"pointer"},attrs:{"icon-class":"goback"},on:{click:e.goBack}})],1),e._v(" "),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"div1"},[i("iframe",{attrs:{src:e.onlineFileUrl,frameborder:"0",width:"100%",height:"100%"}})])]),e._v(" "),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"div1"},[i("div",{staticStyle:{"margin-bottom":"10px"}},["0"===e.show||"2"===e.show||"3"===e.show?i("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.openDialog}},[e._v("上传")]):e._e()],1),e._v(" "),i("div",{staticClass:"div2"},[i("el-scrollbar",{staticClass:"hidden-x",staticStyle:{overflow:"hidden",height:"100%"}},[i("el-table",{key:e.tableKey,ref:"filetable",attrs:{data:e.fileList,border:"",fit:"",stripe:"","highlight-current-row":""},on:{"row-click":e.handleCurrent}},[i("el-table-column",{attrs:{label:"文件名",align:"center","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[i("span",[e._v(e._s(s.fileName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"上传时间",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[i("span",[e._v(e._s(s.uploadDate))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"上传人",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[i("span",[e._v(e._s(s.createUsername))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return["2"===e.show||"3"===e.show?i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleModifyStatus(s,"delete")}}},[e._v("删除")]):e._e(),e._v(" "),i("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.handleModifyStatus(s,"down")}}},[e._v("下载")])]}}])})],1)],1)],1)])])],1),e._v(" "),i("el-dialog",{attrs:{title:"上传附件",visible:e.fileDialog,width:"40%","before-close":e.closeFileDialog},on:{"update:visible":function(t){e.fileDialog=t}}},[i("div",{staticClass:"centerPosition"},[i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"","with-credentials":!0,action:e.fileUploadUrl,data:e.fileData,"on-success":e.successFile,"on-error":e.errorFile,"on-remove":e.removeFile}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击上传")])]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持上传word、excel、ofd等格式")])])],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitFile}},[e._v("确 定")]),e._v(" "),i("el-button",{on:{click:e.closeFileDialog}},[e._v("取 消")])],1)])],1)},a=[],l=i("7a03"),n={name:"DetailFiles",props:{info:{type:Object,default:function(){return{}}}},data:function(){return{show:this.$store.state.user.userInfo.adminFlag,tableKey:0,fileDialog:!1,fileData:{access_token:this.$store.state.user.token,id:this.info.id},fileUploadUrl:"/app/xlgl/xlglsafetyanalyse/uploadPicture",onlineFileUrl:"",fileList:[],uploadFileList:[]}},created:function(){this.getYaFileList()},methods:{getYaFileList:function(){var e=this,t={organId:this.info.organId,id:this.info.id};Object(l["f"])(t).then(function(t){if(e.fileList=t.data,e.fileList.length>0){e.$refs.filetable.setCurrentRow(e.fileList[0]);var i=e.fileList[0].fileName,s=i.substring(i.lastIndexOf(".")+1).toLocaleUpperCase();"PDF"===s?e.onlineFileUrl="/app/pdf.js/web/viewer.html?fileId="+e.fileList[0].fileIds+"&access_token="+e.$store.state.user.token:e.$message({type:"info",message:"请下载对应的文件再进行查看！"})}})},handleCurrent:function(e){this.$refs.filetable.setCurrentRow(e);var t=e.fileName,i=t.substring(t.lastIndexOf(".")+1).toLocaleUpperCase();"PDF"===i?this.onlineFileUrl="/app/pdf.js/web/viewer.html?fileId="+e.fileIds+"&access_token="+this.$store.state.user.token:this.$message({type:"info",message:"请下载对应的文件再进行查看！"})},handleModifyStatus:function(e,t){var i=this;"delete"===t?Object(l["a"])({ids:e.id}).then(function(e){0===e.data.code?i.$message({type:"success",message:"删除成功!",onClose:function(){i.getYaFileList()}}):i.$message({type:"info",message:e.data.msg})}):"down"===t&&(window.location.href="xlgl/xlglsafetyanalyse/downLoad?fileId="+e.fileIds+"&access_token="+this.$store.state.user.token)},openDialog:function(){this.fileDialog=!0},closeFileDialog:function(){this.uploadFileList=[],this.$refs.upload.clearFiles(),this.fileDialog=!1},submitFile:function(e){var t=this;this.fileData.fileIds=this.uploadFileList.join(","),Object(l["h"])(this.fileData).then(function(e){0===e.data.code?t.$message({type:"success",message:"上传成功!",onClose:function(){t.getYaFileList(),t.closeFileDialog()}}):t.$message({type:"info",message:"保存失败!"})})},successFile:function(e){"0"===e.code&&e.fileId&&e.fileId.length>0?this.uploadFileList.push(e.fileId):this.$message({type:"info",message:"上传失败!"})},errorFile:function(){this.$message({type:"info",message:"上传失败!"})},removeFile:function(e){var t=this.uploadFileList.indexOf(e.response.fileId);-1!==t&&this.uploadFileList.splice(t,1)},goBack:function(){this.$parent.detailFlag=!1}}},o=n,r=(i("cb2c"),i("2877")),c=Object(r["a"])(o,s,a,!1,null,"0f4f4c9c",null);t["default"]=c.exports}}]);