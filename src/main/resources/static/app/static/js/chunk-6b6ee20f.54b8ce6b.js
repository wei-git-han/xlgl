(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b6ee20f"],{a141:function(t,e,a){},af91:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addPage"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{staticStyle:{"padding-bottom":"100px",position:"relative"}},[a("title-card",{attrs:{"title-text":"训管动态新增"}}),t._v(" "),a("svg-icon",{staticClass:"icon",staticStyle:{cursor:"pointer",position:"absolute",right:"20px",top:"15px"},attrs:{"icon-class":"goback"},on:{click:t.backFn}}),t._v(" "),a("div",{staticStyle:{padding:"20px 0"}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"150px"}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"动态类型",prop:"newsType",required:""}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.newsType,callback:function(e){t.$set(t.form,"newsType",e)},expression:"form.newsType"}},[a("el-option",{attrs:{label:"上级工作动态",value:"上级工作动态"}}),t._v(" "),a("el-option",{attrs:{label:"机关部队训练风采",value:"机关部队训练风采"}}),t._v(" "),a("el-option",{attrs:{label:"安全管理",value:"安全管理"}})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"发布单位",required:""}},[a("el-input",{attrs:{disabled:""},model:{value:t.deptName,callback:function(e){t.deptName=e},expression:"deptName"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"动态标题",required:""}},[a("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"编辑内容"}},[a("ueditor",{ref:"content",model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"上传封面"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{accept:".png,.jpeg",drag:"",action:t.fileUrl,data:t.access_token,name:"pdf","file-list":t.imgList,limit:1,"on-success":t.uploadImg,"on-error":t.errorFile,"on-remove":t.removeImg,multiple:""}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("\n                  将文件拖到此处，或"),a("em",[t._v("点击上传")]),t._v(" "),a("div",{staticStyle:{color:"#BBBBBB","font-size":"12px"}},[t._v("注：只能上传.mp4/.png/.jpeg等文件格式")])])])],1)],1)],1)],1),t._v(" "),a("el-col",{staticStyle:{"text-align":"center","margin-top":"30px"},attrs:{span:24}},[a("el-button",{attrs:{type:"success"},on:{click:t.saveFn}},[t._v("发布")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.saveDraft}},[t._v("存草稿")])],1)],1)],1)],1)},i=[],o=a("aa2a"),l=a("35b7"),n=a("63f4"),r={components:{Ueditor:n["a"],TitleCard:l["a"]},props:{id:{type:String,default:""}},data:function(){return{form:{title:"",newsType:"",content:"",pIds:"",picutureName:""},deptName:"",imgList:[],fileUrl:"/app/xlgl/news/upLoadFile",access_token:this.$store.state.user.token}},created:function(){this.getDeptName(),this.id&&this.eidtOrUpdate()},methods:{getDeptName:function(){var t=this;Object(o["c"])().then(function(e){t.deptName=e.data.deptName})},eidtOrUpdate:function(){var t=this;Object(o["e"])({id:this.id}).then(function(e){var a=e.data.xlglNews,s=a.title,i=a.newsType,o=a.content;Object.assign(t.form,{title:s,newsType:i,content:o}),e.data.xlglNews.picturePath&&t.imgList.push({name:e.data.xlglNews.pictureName,url:e.data.xlglNews.picturePath}),t.$refs.content.setContent(t.form.content)})},backFn:function(){this.$emit("back")},uploadImg:function(t){t.fileId&&t.fileId.length>0?(this.form.pIds=t.fileId,this.form.picutureName=t.picutureName):this.errorFile()},errorFile:function(){this.$message({type:"info",message:"上传失败!"})},removeImg:function(){this.form.picutureName="",this.form.pIds=""},saveData:function(t){var e=this;this.form.newsType?this.form.title?(this.form.isRelease=t,this.id&&(this.form.id=this.id),Object(o["h"])(this.form).then(function(t){"success"===t.data.result?e.$message({type:"success",message:e.id?"修改成功":"发布成功!"}):e.$message({type:"info",message:e.id?"修改失败":"发布失败!"}),e.form="",e.backFn()})):this.$message({message:"请输入动态标题",type:"info"}):this.$message({message:"请选择动态类型",type:"info"})},saveFn:function(){this.saveData(1)},saveDraft:function(){this.saveData(0)}}},c=r,p=(a("ff9c"),a("2877")),m=Object(p["a"])(c,s,i,!1,null,"7c111928",null);e["default"]=m.exports},ff9c:function(t,e,a){"use strict";var s=a("a141"),i=a.n(s);i.a}}]);