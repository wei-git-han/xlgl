(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17317f9f"],{"8d17":function(e,t,i){},aa6a:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"app-content"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{staticClass:"borderSty",staticStyle:{"padding-bottom":"100px"}},[i("div",{staticClass:"addTitle"},[i("span",[e._v("通知公告新增")]),e._v(" "),i("svg-icon",{staticClass:"icon",staticStyle:{cursor:"pointer","margin-top":"10px"},attrs:{"icon-class":"goback"},on:{click:e.backFn}})],1),e._v(" "),i("div",{staticStyle:{padding:"20px 0"}},[i("el-form",{ref:"form",attrs:{"label-width":"150px"},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"信息类型",required:""}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.infoType,function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.name}},[e._v(e._s(t.name))])}),1)],1)],1),e._v(" "),i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"发布单位",required:""}},[i("el-input",{attrs:{disabled:""},model:{value:e.form.releaseOrgan,callback:function(t){e.$set(e.form,"releaseOrgan",t)},expression:"form.releaseOrgan"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"信息标题",required:""}},[i("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:10}},[i("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"发布时间",required:""}},[i("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择发布时间"},model:{value:e.form.releaseTimeStr,callback:function(t){e.$set(e.form,"releaseTimeStr",t)},expression:"form.releaseTimeStr"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:20}},[i("el-form-item",{attrs:{label:"编辑内容"}},[i("ueditor",{model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:20}},[i("el-form-item",{attrs:{label:"上传附件"}},[i("div",{staticStyle:{border:"1px solid #ccc",padding:"20px","border-radius":"4px"}},[i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:e.fileUrl,data:e.form,"on-success":e.successFile,"on-error":e.errorFile,"on-remove":e.removeFile,multiple:""}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击上传")])]),e._v(" "),i("div",{staticClass:"el-upload__tip",staticStyle:{color:"#BBBBBB"},attrs:{slot:"tip"},slot:"tip"},[e._v("上传word、excel、ofd等文件格式")])]),e._v(" "),i("div",{staticClass:"fileList"},[i("ul",e._l(e.fileLists,function(t){return i("li",{key:t.fileId},[e._v("\n                        "+e._s(t.pictureName)+"\n                        "),i("span",{staticClass:"colorSty1 gapSty",on:{click:function(i){return i.stopPropagation(),e.deleteFileById(t.pictureId)}}},[e._v("删除")]),e._v(" "),i("span",{staticClass:"colorSty1 gapSty",on:{click:function(i){return i.stopPropagation(),e.download(t.pictureId)}}},[e._v("下载")])])}),0)])],1)])],1)],1)],1),e._v(" "),i("el-col",{staticStyle:{"text-align":"center","margin-top":"30px"},attrs:{span:24}},[i("el-button",{attrs:{type:"success"},on:{click:e.saveOrUpdateNotice}},[e._v("发布")]),e._v(" "),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.backFn}},[e._v("取消")])],1)],1)],1)],1)])},a=[],l=i("aa2a"),o=i("13c4"),n=i("63f4"),r={name:"CreateNotice",components:{Ueditor:n["a"]},props:{noticeId:{type:String,default:""}},data:function(){return{infoType:[{name:"通知",value:"1"},{name:"公告",value:"0"}],fileUrl:"/app/xlgl/xlglnotice/uploadPicture",fileList:[],form:{type:"",title:"",content:"",releaseTimeStr:"",releaseOrgan:"",access_token:this.$store.state.user.token},fileLists:[]}},created:function(){this.noticeId?this.getNoticeInfo():this.getDeptName()},methods:{getDeptName:function(){var e=this;Object(l["d"])().then(function(t){e.form.releaseOrgan=t.data.deptName})},backFn:function(){this.$emit("back","1")},successFile:function(e){e.fileid&&e.fileid.length>0?this.fileList.push(e.fileid):this.$message({type:"info",message:"上传失败!"})},errorFile:function(){this.$message({type:"info",message:"上传失败!"})},removeFile:function(e){var t=this.fileList.indexOf(e.response.fileid);-1!==t&&this.fileList.splice(t,1)},saveOrUpdateNotice:function(){var e=this;this.form.type||this.$message({type:"warning",message:"请选择信息类型!"}),this.form.title||this.$message({type:"warning",message:"请输入信息标题!"}),this.form.releaseTimeStr||this.$message({type:"warning",message:"请选择发布时间!"}),this.form.type&&this.form.title&&this.form.releaseTimeStr&&(this.form.pIds=this.fileList.join(","),Object(o["i"])(this.form).then(function(t){e.$message({type:"success",message:"发布成功!",onClose:function(){e.$parent.showPage="1"}})}))},getNoticeInfo:function(){var e=this,t={id:this.noticeId};Object(o["f"])(t).then(function(t){e.form.id=t.data.xlglNotice.id,e.form.type=t.data.xlglNotice.type,e.form.releaseOrgan=t.data.xlglNotice.releaseOrgan,e.form.title=t.data.xlglNotice.title,e.form.content=t.data.xlglNotice.content,e.form.releaseTimeStr=t.data.xlglNotice.releaseTime,e.$nextTick(function(){this.getFileList()})})},getFileList:function(){var e=this;Object(o["d"])({id:this.noticeId}).then(function(t){e.fileLists=t.data.list})},deleteFileById:function(e){var t=this,i={picId:e};Object(o["b"])(i).then(function(e){0===e.data.code?t.$message({type:"success",message:"删除成功!",onClose:function(){t.getFileList()}}):t.$message({type:"indo",message:"删除失败!"})})},download:function(e){window.location.href="xlgl/xlglnotice/downloadPicture?fileId="+e+"&access_token="+this.$store.state.user.token}}},c=r,f=(i("b410"),i("2877")),d=Object(f["a"])(c,s,a,!1,null,"0a36c104",null);t["default"]=d.exports},b410:function(e,t,i){"use strict";var s=i("8d17"),a=i.n(s);a.a}}]);