(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e60004a"],{"1d27":function(e,t,s){"use strict";var a=s("2fd7"),i=s.n(a);i.a},"2fd7":function(e,t,s){},af91:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"addPage"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticStyle:{"padding-bottom":"100px",position:"relative"}},[s("title-card",{attrs:{"title-text":"训管动态新增"}}),e._v(" "),s("svg-icon",{staticClass:"icon",staticStyle:{cursor:"pointer",position:"absolute",right:"20px",top:"15px"},attrs:{"icon-class":"goback"},on:{click:e.backFn}}),e._v(" "),s("div",{staticStyle:{padding:"20px 0"}},[s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"150px"}},[s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"动态类型",prop:"newsType",required:""}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.newsType,callback:function(t){e.$set(e.form,"newsType",t)},expression:"form.newsType"}},[s("el-option",{attrs:{label:"上级工作动态",value:"上级工作动态"}}),e._v(" "),s("el-option",{attrs:{label:"机关部队训练风采",value:"机关部队训练风采"}}),e._v(" "),s("el-option",{attrs:{label:"安全管理",value:"安全管理"}})],1)],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"发布单位",required:""}},[s("el-input",{attrs:{disabled:""},model:{value:e.deptName,callback:function(t){e.deptName=t},expression:"deptName"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"动态标题",required:""}},[s("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:20}},[s("el-form-item",{attrs:{label:"编辑内容"}},[s("ueditor",{ref:"content",model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"上传封面"}},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{accept:".png,.jpeg",drag:"",action:e.fileUrl,data:e.access_token,name:"pdf","file-list":e.imgList,limit:1,"on-success":e.uploadImg,"on-error":e.errorFile,"on-remove":e.removeImg,multiple:""}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("\n                  将文件拖到此处，或"),s("em",[e._v("点击上传")]),e._v(" "),s("div",{staticStyle:{color:"#BBBBBB","font-size":"12px"}},[e._v("注：只能上传.mp4/.png/.jpeg等文件格式")])])])],1)],1)],1)],1),e._v(" "),s("el-col",{staticStyle:{"text-align":"center","margin-top":"30px"},attrs:{span:24}},[s("el-button",{attrs:{type:"success"},on:{click:e.saveFn}},[e._v("发布")]),e._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:"0"!=e.flag,expression:"flag!='0'"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.saveDraft}},[e._v("存草稿")])],1)],1)],1)],1)},i=[],l=s("aa2a"),o=s("35b7"),n=s("63f4"),r={components:{Ueditor:n["a"],TitleCard:o["a"]},props:{id:{type:String,default:""},flag:{type:String,default:""}},data:function(){return{form:{title:"",newsType:"",content:"",pIds:"",picutureName:""},deptName:"",isRelease:"",imgList:[],fileUrl:"/app/xlgl/news/upLoadFile",access_token:this.$store.state.user.token}},created:function(){this.getDeptName(),this.id&&this.eidtOrUpdate()},methods:{getDeptName:function(){var e=this;Object(l["d"])().then(function(t){e.deptName=t.data.deptName})},eidtOrUpdate:function(){var e=this;Object(l["f"])({id:this.id}).then(function(t){var s=t.data.xlglNews,a=s.title,i=s.newsType,l=s.content;Object.assign(e.form,{title:a,newsType:i,content:l}),e.isRelease=t.data.xlglNews.isRelease,t.data.xlglNews.picturePath&&e.imgList.push({name:t.data.xlglNews.pictureName,url:t.data.xlglNews.picturePath}),e.$refs.content.setContent(e.form.content)})},backFn:function(){this.$emit("back",0)},uploadImg:function(e){e.fileId&&e.fileId.length>0?(this.form.pIds=e.fileId,this.form.picutureName=e.picutureName):this.errorFile()},errorFile:function(){this.$message({type:"info",message:"上传失败!"})},removeImg:function(e){var t=this;Object(l["c"])({infoId:this.id,pictureId:e.url}).then(function(e){"success"===e.data.result?(t.$message({message:"图片删除成功",type:"success"}),t.form.picutureName="",t.form.pIds=""):t.$message({type:"info",message:"图片删除失败!"})})},saveData:function(e){var t=this;this.form.newsType?this.form.title?(this.form.isRelease=e,this.id&&(this.form.id=this.id),Object(l["i"])(this.form).then(function(s){"success"===s.data.result?t.id?("1"===e&&"1"===t.isRelease&&t.$message({type:"success",message:"修改成功"}),"0"===e&&t.$message({type:"success",message:"存入草稿箱成功"}),"1"===e&&"0"===t.isRelease&&t.$message({type:"success",message:"发布成功"})):("1"===e&&t.$message({type:"success",message:"发布成功"}),"0"===e&&t.$message({type:"success",message:"存入草稿箱成功"})):t.id?("1"===e&&"1"===t.isRelease&&t.$message({type:"success",message:"修改失败"}),"0"===e&&t.$message({type:"success",message:"存入草稿箱失败"}),"1"===e&&"0"===t.isRelease&&t.$message({type:"success",message:"发布失败"})):("1"===e&&t.$message({type:"success",message:"发布失败"}),"0"===e&&t.$message({type:"success",message:"存入草稿箱失败"})),t.form="",t.$emit("back",0)})):this.$message({message:"请输入动态标题",type:"info"}):this.$message({message:"请选择动态类型",type:"info"})},saveFn:function(){this.saveData("1")},saveDraft:function(){this.saveData("0")}}},c=r,m=(s("1d27"),s("2877")),p=Object(m["a"])(c,a,i,!1,null,"5ae0a742",null);t["default"]=p.exports}}]);